package aspenTestCases;

import java.io.IOException;
import java.util.List;

import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.FindAll;
import org.openqa.selenium.support.FindBy;
import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.Test;

import aspenPageObjects.AspenHomePage;
import aspenPageObjects.AspenLoginPage;
import testBase.TestBase;
import utilities.readExcelData;

public class AspenMyAccount extends TestBase{

		@Test(enabled=true, groups= {"Smoke"})
	public void MyAccount() throws IOException{
		Object data[][]=readExcelData.readExcelSheet(System.getProperty("user.dir")+"/TestData/TestData1.xls", "userCredentials");	
		extentTest=extentReports.createTest("My Account Test Case");
		for(int i=0;i<data.length;i++){
			String userName=data[i][0].toString();
			String password=data[i][1].toString();
			System.out.println("username###"+userName);		
			AspenHomePage homePage=new AspenHomePage();
			homePage.getLnkMyAccount().click();
			AspenLoginPage login=new AspenLoginPage();

			login.getTxtUserName().sendKeys(userName);
			extentTest.pass("Entered user Name");
			login.getTxtPassword().sendKeys(password);
			extentTest.pass("Entered password");
			login.getBtnSignIn().click();
			System.out.println("Successful login attempt for "+userName);	
		}
	}
}


